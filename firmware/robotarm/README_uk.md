# Прошивка роботизованої руки (Arduino)

Ця версія прошивки додає роботу з датчиками, реле, аварійну зупинку, watchdog та JSON-протокол для дистанційного керування.

## Структура
```
robotarm/
├── config.h          // Параметри апаратури та безпеки
├── json_parser.h     // Обробка JSON-команд та відповіді
├── robotarm.ino      // Точка входу: ініціалізація та головний цикл
├── sensor_reader.h   // Зчитування аналогових датчиків
└── servo_control.h   // Керування PCA9685 із калібруванням серво
```

## Можливості
- **Керування серво (PCA9685)** з індивідуальними межами імпульсів.
- **Читання датчиків**: вологість ґрунту на A0-A3, фоторезистор на A4.
- **Керування реле** через `RELAY_PINS` у `config.h`.
- **Аварійна зупинка** при втраті зв'язку або командою `emergency_stop`.
- **Watchdog таймер** (2 секунди) для автоматичного перезапуску при зависанні.
- **Розширений JSON-протокол** для команд та телеметрії.

## Приклади JSON-команд
```json
{"cmd": "move_servo", "servo": 0, "angle": 90}
{"cmd": "read_sensors"}
{"cmd": "emergency_stop"}
```

## Додаткові нотатки
- Частота PWM виставлена на 50 Гц для стандартних серво.
- `COMMUNICATION_TIMEOUT_MS` визначає час без команд, після якого спрацьовує аварійна зупинка.
- Для зміни калібрування серво оновіть масиви `SERVO_MIN_US`, `SERVO_MAX_US` та `SERVO_NEUTRAL_US` у `config.h`.
- Функція `setRelay` у `robotarm.ino` доступна для подальшого використання в командах/логіці.
